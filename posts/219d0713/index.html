<!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><link href="http://static.niceweb.me/css/code.min.css" rel="stylesheet"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="Node,后端，服务端,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="description" content="【Node入门教程】-了解并使用Http模块.note-content{font-family:微软雅黑,&apos;Helvetica Neue&apos;,Arial,&apos;Hiragino Sans GB&apos;,STHeiti,&apos;Microsoft YaHei&apos;,&apos;WenQuanYi Micro Hei&apos;,SimSun,Song,sans-serif}.note-content code,.note-content h"><meta name="keywords" content="Node,后端，服务端"><meta property="og:type" content="article"><meta property="og:title" content="【Node入门教程】-了解并使用Http模块"><meta property="og:url" content="http://blog.iqianduan.wang/posts/219d0713/index.html"><meta property="og:site_name" content="前端观察"><meta property="og:description" content="【Node入门教程】-了解并使用Http模块.note-content{font-family:微软雅黑,&apos;Helvetica Neue&apos;,Arial,&apos;Hiragino Sans GB&apos;,STHeiti,&apos;Microsoft YaHei&apos;,&apos;WenQuanYi Micro Hei&apos;,SimSun,Song,sans-serif}.note-content code,.note-content h"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2018-10-23T07:32:36.802Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="【Node入门教程】-了解并使用Http模块"><meta name="twitter:description" content="【Node入门教程】-了解并使用Http模块.note-content{font-family:微软雅黑,&apos;Helvetica Neue&apos;,Arial,&apos;Hiragino Sans GB&apos;,STHeiti,&apos;Microsoft YaHei&apos;,&apos;WenQuanYi Micro Hei&apos;,SimSun,Song,sans-serif}.note-content code,.note-content h"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"right",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"作者"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.iqianduan.wang/posts/219d0713/"><title>【Node入门教程】-了解并使用Http模块 | 前端观察</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">前端观察</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>文章</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.iqianduan.wang/posts/219d0713/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="7*"><meta itemprop="description" content="尘世中一枚迷途的小前端er"><meta itemprop="image" content="https://avatars0.githubusercontent.com/u/7498226?v=4&u=60bc9fd6e63144c1fd975814086a9fd328da90c6&s=400"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="前端观察"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">【Node入门教程】-了解并使用Http模块</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-21T12:37:35+08:00">2018-10-21 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Node/" itemprop="url" rel="index"><span itemprop="name">Node</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/posts/219d0713/#SOHUCS" itemprop="discussionUrl"><span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="posts/219d0713/" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><!DOCTYPE html><html><head><title>【Node入门教程】-了解并使用Http模块</title><meta charset="utf-8"><link href="https://cdn.maxiang.io/res-min/themes/marxico.css" rel="stylesheet"><style>.note-content{font-family:微软雅黑,'Helvetica Neue',Arial,'Hiragino Sans GB',STHeiti,'Microsoft YaHei','WenQuanYi Micro Hei',SimSun,Song,sans-serif}.note-content code,.note-content h1,.note-content h2,.note-content h3,.note-content h4,.note-content h5.div,.note-content p,.note-content pre{line-height:2}</style></head><body><div id="preview-contents" class="note-content"><h1 id="node入门教程-了解并使用http模块">Node入门教程-了解并使用Http模块</h1><blockquote><p>上一节，我们用Http模块搭建了一个hello world服务器。现在我们就来了解了解Http模块，学习它的常用API，并在最后实现两个小案例。<br>http模块主要用于搭建HTTP服务。使用Node搭建HTTP服务器非常简单。</p></blockquote><p><em>按理说，我们应该先讲讲NPM，package.json。但我觉得先讲讲Http模块实现两个小案例，可以让各位看官更有兴趣，能够愉悦的学习使用Node.js</em></p><p>我想你可能已经学会了看官网的文档，但脑子在想这是什么鬼，的确，Node.js的文档对初学者不太友好。很多用不上，例子太少。大体来说Http模块，主要的应用是两部分，一部分是http.createServer 担当web服务器，另一部分是http.createClient，担当客户端，实现爬虫之类的工作。下文将从这两方面着手介绍HTTP api。</p><h2 id="1http服务器">1.Http服务器</h2><p>看上一节例子</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-keyword">const</span> hostname = <span class="hljs-string">'127.0.0.1'</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">const</span> port = <span class="hljs-number">3000</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>  res.statusCode = <span class="hljs-number">200</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>  res.setHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/plain'</span>) <span class="hljs-comment">//writeHead，200表示页面正常，text/plain表示是文字。</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>  res.end(<span class="hljs-string">'Hello World\n'</span>) <span class="hljs-comment">// end 完成写入</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>})
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>server.listen(port, hostname, () =&gt; {
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`服务器运行在 http://<span class="hljs-subst">${hostname}</span>:<span class="hljs-subst">${port}</span>`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>})
</div></code></pre><ol><li rel="1">首先 使用 HTTP 服务器和客户端必须 <code>require('http')</code>。</li><li rel="2">然后使用<code>http.createServer([requestListener])</code>来创建一个web服务器，其中传入一个可选的回调函数，这回调函数有两个参数分别代表客户端请求与服务器端的响应对象</li><li rel="3">使用 <code>server.listen([port][, hostname][, backlog][, callback])</code>开始在指定的 port 和 hostname 上接受连接</li></ol><p>简单的3步一个http服务器就建好，有打开就有关闭</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>server.close([callback]) <span class="hljs-comment">// 停止服务端接收新的连接</span>
</div></code></pre><p>Node.jsHttp模块也提供了<code>server.timeout</code>用于查看或设置超时</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>server.timeout = <span class="hljs-number">1000</span> <span class="hljs-comment">//设置超时为1秒</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-built_in">console</span>.log(server.timeout)
</div></code></pre><h3 id="获取客户端请求信息">获取客户端请求信息</h3><h4 id="request对象">request对象</h4><ul><li><code>request.url</code> 客户端请求的url地址</li><li><code>request.headers</code> 客户端请求的http header</li><li><code>request.method</code> 获取请求的方式，一般有几个选项，POST,GET和DELETE等，服务器可以根据客户端的不同请求方法进行不同的处理。</li><li><code>request.httpVersion</code> http的版本</li><li><code>request.trailers</code> 存放附加的一些http头信息</li><li><code>request.socket</code> 用于监听客户端请求的socket对象</li></ul><p>我们可以写一小段js讲客户端的请求信息保存在log.txt中</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>) <span class="hljs-comment">//引入http模块</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>) <span class="hljs-comment">//引入fs模块 文件 I/O</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-keyword">const</span> hostname = <span class="hljs-string">'127.0.0.1'</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">const</span> port = <span class="hljs-number">3000</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> { <span class="hljs-comment">//创建一个http服务器</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>  res.statusCode = <span class="hljs-number">200</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>  res.setHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/plain'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>  <span class="hljs-keyword">if</span>(req.url !== <span class="hljs-string">'/favicon.ico'</span>){
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>      <span class="hljs-keyword">let</span> out = fs.createWriteStream(<span class="hljs-string">'./log.txt'</span>) <span class="hljs-comment">// 创建写入流</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>      out.write(<span class="hljs-string">`请求方法：<span class="hljs-subst">${req.method}</span> \n`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>      out.write(<span class="hljs-string">`请求url：<span class="hljs-subst">${req.url}</span> \n`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>      out.write(<span class="hljs-string">`请求头对象：<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(req.headers, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>)}</span> \n`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>      out.write(<span class="hljs-string">`请求http版本：<span class="hljs-subst">${req.httpVersion}</span> \n`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>  }
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span>  res.end(<span class="hljs-string">'Hello World\n'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>})
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>server.listen(port, hostname, () =&gt; {
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`服务器运行在 http://<span class="hljs-subst">${hostname}</span>:<span class="hljs-subst">${port}</span>`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>})
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>log.txt
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>============================================
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>请求方法：GET
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>请求url：/
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>请求头对象：{
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>    <span class="hljs-string">"host"</span>: <span class="hljs-string">"127.0.0.1:3000"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>    <span class="hljs-string">"connection"</span>: <span class="hljs-string">"keep-alive"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>    <span class="hljs-string">"cache-control"</span>: <span class="hljs-string">"max-age=0"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>    <span class="hljs-string">"upgrade-insecure-requests"</span>: <span class="hljs-string">"1"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>    <span class="hljs-string">"user-agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>    <span class="hljs-string">"accept-encoding"</span>: <span class="hljs-string">"gzip, deflate, sdch, br"</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>    <span class="hljs-string">"accept-language"</span>: <span class="hljs-string">"zh-CN,zh;q=0.8,en;q=0.6"</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span>}
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>请求http版本：<span class="hljs-number">1.1</span>
</div></code></pre><h3 id="response对象">response对象</h3><ul><li><code>response.writeHead(statusCode, [reasonPhrase], [headers])</code>写服务端入响应头部信息</li><li><code>response.header</code> 返回的http header，可以是字符串，也可以是对象</li><li><code>response.setTimeout(msecs, callback)</code>设置http超时返回的时间，一旦超过了设定时间，连接就会被丢弃</li><li><code>response.statusCode</code> 设置返回的网页状态码</li><li><code>response.setHeader(name, value)</code>设置http协议头</li><li><code>response.headersSent</code>判断是否设置了http的头</li><li><code>response.write(chunk, [encoding])</code> 返回的网页数据，[encoding] 默认是 utf-8</li><li><code>response.end([data], [encoding])</code></li></ul><h3 id="url解析">URL解析</h3><p>在Node.js中，提供了一个<a href="http://nodejs.cn/api/url.html" target="_blank"><code>url</code></a>模块与<a href="http://nodejs.cn/api/querystring.html" target="_blank"><code>querystring (查询字符串)</code></a>模块</p><h4 id="querystring模块-用于-url-处理与解析"><code>querystring</code>模块 用于 URL 处理与解析</h4><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>querystring.parse(str, [sep], [eq], [options]) <span class="hljs-comment">// 将字符串转成对象</span>
</div></code></pre><table><tbody><tr style="font-weight:700"><td>欲转换的字符串</td><td>str</td></tr><tr><td>设置分隔符，默认为 ‘&amp;’</td><td>sep</td></tr><tr><td>设置赋值符，默认为 ‘=’</td><td>eq</td></tr><tr><td>可接受字符串的最大长度，默认为1000</td><td>[options] maxKeys</td></tr></tbody></table><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-comment">// 例子:</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>querystring.parse(<span class="hljs-string">'foo=bar&amp;baz=qux&amp;baz=quux&amp;corge'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-comment">// returns</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>{ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span>, <span class="hljs-attr">baz</span>: [<span class="hljs-string">'qux'</span>, <span class="hljs-string">'quux'</span>], <span class="hljs-attr">corge</span>: <span class="hljs-string">''</span> }
</div></code></pre><p><code>querystring.stringify(obj,separator,eq,options)</code>这个方法是将一个对象序列化成一个字符串，与<code>querystring.parse</code>相对。</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>querystring.stringify({<span class="hljs-attr">name</span>: <span class="hljs-string">'whitemu'</span>, <span class="hljs-attr">sex</span>: [ <span class="hljs-string">'man'</span>, <span class="hljs-string">'women'</span> ] });
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-comment">// returns</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-string">'name=whitemu&amp;sex=man&amp;sex=women'</span>
</div></code></pre><h4 id="url-模块提供了一些实用函数用于-url-处理与解析">url 模块提供了一些实用函数，用于 URL 处理与解析</h4><p>一个 URL 字符串是一个结构化的字符串，它包含多个有意义的组成部分。 当被解析时，会返回一个 URL 对象，它包含每个组成部分作为属性。</p><p>以下详情描述了一个解析后的 URL 的每个组成部分</p><pre class="prettyprint with-line-number hljs-dark"><code class="hljs stata"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>┌─────────────────────────────────────────────────────────────────────────────┐
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span>│                                    href                                     │
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>├──────────┬┬───────────┬─────────────────┬───────────────────────────┬───────┤
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>│ protocol ││   auth    │      host       │           path            │ hash  │
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>│          ││           ├──────────┬──────┼──────────┬────────────────┤       │
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>│          ││           │ hostname │ port │ pathname │     <span class="hljs-keyword">search</span>     │       │
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>│          ││           │          │      │          ├─┬──────────────┤       │
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span>│          ││           │          │      │          │ │    <span class="hljs-keyword">query</span>     │       │
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-string">"  http:   // user:pass @ host.com : 8080   /p/a/t/h  ?  query=string   #hash "</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>│          ││           │          │      │          │ │              │       │
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>└──────────┴┴───────────┴──────────┴──────┴──────────┴─┴──────────────┴───────┘
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>(请忽略字符串中的空格，它们只是为了格式化)
</div></code></pre><p><code>url.format(urlObject)</code> 返回一个从 urlObject 格式化后的 URL 字符串<br><code>url.parse(urlString[, parseQueryString[, slashesDenoteHost]])</code> 解析一个 URL 字符串并返回一个 URL 对象</p><p>我们可以使用<code>url.parse()</code>解析出的对象来获取URL中的各个值</p><p>更多请参考<a href="http://nodejs.cn/api/querystring.html" target="_blank">node中文网</a></p><h3 id="实例http-json-api-服务器">实例：HTTP JSON API 服务器</h3><p>编写一个 HTTP 服务器，每当接收到一个路径为 ‘/api/parsetime’ 的 GET<br>请求的时候，响应一些 JSON 数据。我们期望请求会包含一个查询参数（query<br>string），key 是 “iso”，值是 ISO 格式的时间。</p><ul><li><p>/api/parsetime?iso=2017-04-05T12:10:15.474Z</p><p>所响应的 JSON 应该只包含三个属性：’hour’，’minute’ 和 ‘second’。例如：</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-json hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-attr">"hour"</span>:<span class="hljs-number">21</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><span class="hljs-attr">"minute"</span>:<span class="hljs-number">45</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-attr">"second"</span>:<span class="hljs-number">30</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>}
</div></code></pre></li><li><p>/api/unixtime?iso=2017-04-05T12:10:15.474Z，它的返回会包含一个属性：’unixtime’，相应值是一个 UNIX</p><p>时间戳。例如:</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-json hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>{ <span class="hljs-attr">"unixtime"</span>: <span class="hljs-number">1376136615474</span> }
</div></code></pre></li></ul><p>具体代码如下</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">const</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">'url'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span><span class="hljs-keyword">const</span> hostname = <span class="hljs-string">'127.0.0.1'</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span><span class="hljs-keyword">const</span> port = <span class="hljs-number">3000</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span><span class="hljs-comment">// 解析时间的函数</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parsetime</span>(<span class="hljs-params">time</span>) </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span>    <span class="hljs-keyword">return</span> {
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>        <span class="hljs-attr">hour</span>: time.getHours(),
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>        <span class="hljs-attr">minute</span>: time.getMinutes(),
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>        <span class="hljs-attr">second</span>: time.getSeconds()
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>}
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unixtime</span>(<span class="hljs-params">time</span>) </span>{
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">unixtime</span>: time.getTime() }
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span>}
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">20.</span><span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
</div><div class="hljs-line"><span class="hljs-comment line-number">21.</span>    <span class="hljs-keyword">let</span> parsedUrl = url.parse(req.url, <span class="hljs-literal">true</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">22.</span>    <span class="hljs-keyword">let</span> time = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(parsedUrl.query.iso)
</div><div class="hljs-line"><span class="hljs-comment line-number">23.</span>    <span class="hljs-keyword">let</span> result
</div><div class="hljs-line"><span class="hljs-comment line-number">24.</span>    <span class="hljs-comment">// 主页 返回当前时间的json</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">25.</span>    <span class="hljs-keyword">if</span>(req.url==<span class="hljs-string">'/'</span>){
</div><div class="hljs-line"><span class="hljs-comment line-number">26.</span>        result = parsetime(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())
</div><div class="hljs-line"><span class="hljs-comment line-number">27.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">28.</span>    <span class="hljs-comment">// 返回查询时间的json</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">29.</span>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\/api\/parsetime/</span>.test(req.url)) {
</div><div class="hljs-line"><span class="hljs-comment line-number">30.</span>        result = parsetime(time)
</div><div class="hljs-line"><span class="hljs-comment line-number">31.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">32.</span>    <span class="hljs-comment">// 返回查询时间的unixtime</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">33.</span>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\/api\/unixtime/</span>.test(req.url)) {
</div><div class="hljs-line"><span class="hljs-comment line-number">34.</span>        result = unixtime(time)
</div><div class="hljs-line"><span class="hljs-comment line-number">35.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">36.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">37.</span>    <span class="hljs-keyword">if</span> (result) {
</div><div class="hljs-line"><span class="hljs-comment line-number">38.</span>        res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> })
</div><div class="hljs-line"><span class="hljs-comment line-number">39.</span>        res.end(<span class="hljs-built_in">JSON</span>.stringify(result))
</div><div class="hljs-line"><span class="hljs-comment line-number">40.</span>    } <span class="hljs-keyword">else</span> {
</div><div class="hljs-line"><span class="hljs-comment line-number">41.</span>        res.writeHead(<span class="hljs-number">404</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">42.</span>        res.end()
</div><div class="hljs-line"><span class="hljs-comment line-number">43.</span>    }
</div><div class="hljs-line"><span class="hljs-comment line-number">44.</span>})
</div><div class="hljs-line"><span class="hljs-comment line-number">45.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">46.</span>server.listen(port, hostname, () =&gt; {
</div><div class="hljs-line"><span class="hljs-comment line-number">47.</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`服务器运行在 http://<span class="hljs-subst">${hostname}</span>:<span class="hljs-subst">${port}</span>`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">48.</span>})
</div></code></pre><h2 id="2http客户端">2.Http客户端</h2><p>在Node.js可以很容易的使用request方法想向其他网站求数据，也可以用<code>http.get(options[, callback])</code></p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span>http.request(options, callback)
</div></code></pre><p>request方法的options参数，可以是一个对象，也可以是一个字符串。如果是字符串，就表示这是一个URL，Node内部就会自动调用<code>url.parse()</code>，处理这个参数。</p><p><code>http.request()</code>返回一个<code>http.ClientRequest</code>类的实例。它是一个可写数据流，如果你想通过POST方法发送一个文件，可以将文件写入这个ClientRequest对象</p><p>现在我们拿<a href="http://www.example.com" target="_blank">www.example.com</a>试试</p><pre class="prettyprint with-line-number hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">2.</span><span class="hljs-keyword">let</span> options = {
</div><div class="hljs-line"><span class="hljs-comment line-number">3.</span>    <span class="hljs-attr">hostname</span>: <span class="hljs-string">'www.example.com'</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">4.</span>    <span class="hljs-attr">port</span>: <span class="hljs-number">80</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">5.</span>    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
</div><div class="hljs-line"><span class="hljs-comment line-number">6.</span>    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">7.</span>}
</div><div class="hljs-line"><span class="hljs-comment line-number">8.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">9.</span><span class="hljs-keyword">const</span> req = http.request(options, (res) =&gt; {
</div><div class="hljs-line"><span class="hljs-comment line-number">10.</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`STATUS: <span class="hljs-subst">${res.statusCode}</span>`</span>) <span class="hljs-comment">//返回状态码</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">11.</span>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`HEADERS: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(res.headers, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>)}</span>`</span>) <span class="hljs-comment">// 返回头部</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">12.</span>    res.setEncoding(<span class="hljs-string">'utf8'</span>) <span class="hljs-comment">// 设置编码</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">13.</span>    res.on(<span class="hljs-string">'data'</span>, (chunk) =&gt; { <span class="hljs-comment">//监听 'data' 事件</span>
</div><div class="hljs-line"><span class="hljs-comment line-number">14.</span>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`主体: <span class="hljs-subst">${chunk}</span>`</span>)
</div><div class="hljs-line"><span class="hljs-comment line-number">15.</span>    })
</div><div class="hljs-line"><span class="hljs-comment line-number">16.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">17.</span>})
</div><div class="hljs-line"><span class="hljs-comment line-number">18.</span><wbr>
</div><div class="hljs-line"><span class="hljs-comment line-number">19.</span>req.end() <span class="hljs-comment">// end方法结束请求</span>
</div></code></pre><p>到此我们请求到了网站上的信息，基于这些我们可以开发出更有用的爬虫，提取到有用的信息，后续将介绍</p><h2 id="3一些好用的包">3.一些好用的包</h2><ul><li><a href="http://expressjs.com/" target="_blank">express</a> Express 是一个简洁而灵活的 node.js Web应用框架, 提供了一系列强大特性帮助你创建各种 Web 应用，和丰富的 HTTP 工具。</li><li><a href="https://github.com/request/request" target="_blank">request</a> request模块让http请求变的更加简单</li></ul><h2 id="4总结">4.总结</h2><p>本节我们学习使用Http模块建立服务端以及发起本地请求的客户端，并展示了两个超级简单的例子。想必各位看官都已经迫不及待的将Node.js用了起来，甚至觉得有点小激动。下一节，我们还是退回去学习Node的npm，package.json，以及模块机制。然后再学习其他的</p></div></body></html></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持技术分享，您的支持将鼓励我继续创作！</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/pay.jpg" alt="7* WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/pay.jpg" alt="7* Alipay"><p>支付宝打赏</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> 7*</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://blog.iqianduan.wang/posts/219d0713/" title="【Node入门教程】-了解并使用Http模块">http://blog.iqianduan.wang/posts/219d0713/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Node/" rel="tag"># Node</a> <a href="/tags/后端，服务端/" rel="tag"># 后端，服务端</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/8a95a813/" rel="next" title="【Node入门教程】-搭建Node.js开发环境"><i class="fa fa-chevron-left"></i> 【Node入门教程】-搭建Node.js开发环境</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/posts/b33001d8/" rel="prev" title="妙用 scale 与 transfrom-origin，精准控制动画方向">妙用 scale 与 transfrom-origin，精准控制动画方向 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="SOHUCS"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/7498226?v=4&u=60bc9fd6e63144c1fd975814086a9fd328da90c6&s=400" alt="7*"><p class="site-author-name" itemprop="name">7*</p><p class="site-description motion-element" itemprop="description">尘世中一枚迷途的小前端er</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">12</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">15</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#node入门教程-了解并使用http模块"><span class="nav-number">1.</span> <span class="nav-text">Node入门教程-了解并使用Http模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1http服务器"><span class="nav-number">1.1.</span> <span class="nav-text">1.Http服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#获取客户端请求信息"><span class="nav-number">1.1.1.</span> <span class="nav-text">获取客户端请求信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#request对象"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">request对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#response对象"><span class="nav-number">1.1.2.</span> <span class="nav-text">response对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#url解析"><span class="nav-number">1.1.3.</span> <span class="nav-text">URL解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#querystring模块-用于-url-处理与解析"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">querystring模块 用于 URL 处理与解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#url-模块提供了一些实用函数用于-url-处理与解析"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">url 模块提供了一些实用函数，用于 URL 处理与解析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实例http-json-api-服务器"><span class="nav-number">1.1.4.</span> <span class="nav-text">实例：HTTP JSON API 服务器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2http客户端"><span class="nav-number">1.2.</span> <span class="nav-text">2.Http客户端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3一些好用的包"><span class="nav-number">1.3.</span> <span class="nav-text">3.一些好用的包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4总结"><span class="nav-number">1.4.</span> <span class="nav-text">4.总结</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">7*</span></div><div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">!function(){var t,e,n,a,c="cyt9rGKH8",o="41c3e3f3b25a5ff73445fe3e4b1f42e9";if((window.innerWidth||document.documentElement.clientWidth)<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+c+"&conf="+o+'"><\/script>');else{t="https://changyan.sohu.com/upload/changyan.js",e=function(){window.changyan.api.config({appid:c,conf:o})},n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,(a=document.createElement("script")).setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)}}()</script><script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script><script type="text/javascript">var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path;function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".popup").toggle()}var searchFunc=function(e,c,s){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),a=document.getElementById(c),r=document.getElementById(s);a.addEventListener("input",function(){var u=0,d='<ul class="search-result-list">',f=this.value.trim().toLowerCase().split(/[\s\-]+/);r.innerHTML="",1<this.value.trim().length&&t.forEach(function(e){var a=!1,r=e.title.trim().toLowerCase(),c=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),t=decodeURIComponent(e.url),s=-1,o=-1,n=-1;if(""!=r&&f.forEach(function(e,t){s=r.indexOf(e),o=c.indexOf(e),(0<=s||0<=o)&&(a=!0,0==t&&(n=o))}),a){u+=1,d+="<li><a href='"+t+"' class='search-result-title'>"+r+"</a>";var i=e.content.trim().replace(/<[^>]+>/g,"");if(0<=n){var l=n-20,p=n+80;l<0&&(l=0),0==l&&(p=50),p>i.length&&(p=i.length);var h=i.substring(l,p);f.forEach(function(e){var t=new RegExp(e,"gi");h=h.replace(t,'<b class="search-keyword">'+e+"</b>")}),d+='<p class="search-result">'+h+"...</p>"}d+="</li>"}}),d+="</ul>",0==u&&(d='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==f&&(d='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),r.innerHTML=d}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script></body></html>